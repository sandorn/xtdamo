# 更新日志

本文档记录了项目的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划中

-   完善测试覆盖率
-   性能优化和基准测试
-   更多示例和教程

## [0.2.0] - 2025-10-25

### 架构改进 🏗️

-   **分层架构重构**: 建立清晰的 `DmExcute -> ApiProxy -> CoreEngine` 三层架构
-   **方法拆分**: 将 `CoreEngine` 中的键盘和鼠标方法分离到独立的 `Key` 和 `Mouse` 模块
-   **智能路由**: 优化 `DmExcute` 的方法查找机制，支持自动路由到最佳实现
-   **去除冗余**: 清理重复的辅助方法，统一使用标准 API

### 新增 ✨

-   **参数验证机制**: `Config.get_bind_config` 支持完整的参数验证和范围检查
-   **错误处理增强**: `ApiProxy.绑定窗口` 提供详细的错误信息和诊断建议
-   **高级鼠标方法**:
    -   `Mouse.safe_click`: 带随机延迟的安全点击，防检测
    -   `Mouse.click_left/click_right`: 支持持续时间的点击操作
    -   `Mouse.position` 属性：便利的位置获取和设置
-   **版本信息**: `__init__.py` 增加 `__version__` 等元数据
-   **完整文档**: 所有模块和方法都添加了 Google Style 文档字符串

### 改进 🔧

-   **参数处理**: `None` 参数不再覆盖默认配置，正确使用默认值
-   **类型注解**: 完善所有方法的类型注解，支持更好的 IDE 智能提示
-   **延迟配置**: 统一键盘和鼠标的延迟参数类型为 `float`
-   **测试改进**: 优化测试脚本，避免重复的注册/注销循环

### 文档 📚

-   **文件头部注释**: 完善 `key.py` 和 `mouse.py` 的模块文档
-   **方法文档**: 所有方法添加详细的参数说明、返回值、示例和注意事项
-   **架构文档**: 新增 `docs/architecture_update.md` 详细说明架构设计
-   **README 更新**: 增加架构设计部分和使用示例

### 修复 🐛

-   修复 `ApiProxy` 调用 `CoreEngine.BindWindow` 时的参数传递问题
-   修复测试脚本中的重复实例化导致的注册循环问题
-   修复 linter 警告（bare except, ternary operator 等）
-   修复延迟参数类型不匹配的问题（int -> float）

### 技术债务清理 🧹

-   移除 `Key` 类中的 9 个冗余方法
-   移除 `Mouse` 类中的 3 个冗余方法
-   统一方法命名规范（大写=标准 API，小写=增强功能）
-   清理代码格式，符合 ruff 规范

### 依赖分析 📦

-   确认 `typing_extensions` 非必需依赖（Python 3.8+ 已内置所有使用的类型）
-   保持最小化依赖列表，仅包含必需的包

## [0.1.0] - 2025-10-18

### 新增

-   初始版本发布
-   基于大漠插件的 Python 自动化封装库
-   核心功能模块：
    -   鼠标操作模块 (`mouse.py`)
    -   键盘操作模块 (`key.py`)
    -   图像识别模块 (`apiproxy.py`)
    -   核心引擎模块 (`coreengine.py`)
    -   窗口枚举模块 (`enum_wind.py`)
-   配置管理系统：
    -   基础配置管理 (`config.py`)
    -   安全认证信息管理 (`secure_config.py`)
-   依赖检查工具 (`dependencies.py`)
-   时间工具模块 (`time_utils.py`)
-   大漠插件注册管理 (`regsvr.py`)
-   主执行类 (`damo.py`)

### 功能特性

-   支持 32 位 Python 环境（大漠插件要求）
-   统一的配置管理
-   多种存储方式的认证信息管理
-   智能依赖检查
-   完整的错误处理机制
-   详细的文档和示例

### 技术特性

-   类型注解支持
-   模块化设计
-   异常处理机制
-   配置验证
-   依赖管理

### 文档

-   完整的 README 文档
-   环境设置指南
-   配置管理文档
-   迁移指南
-   贡献指南
-   版本迭代规范

### 开发工具

-   代码检查工具配置 (ruff)
-   类型检查器配置 (pyright, mypy)
-   测试框架配置
-   CI/CD 配置

### 示例

-   基础使用示例
-   配置使用示例
-   依赖检查示例
-   环境检查工具

### 安全

-   加密存储支持
-   Windows 凭据管理器集成
-   安全的认证信息管理

---

## 版本说明

### 版本号格式

-   **主版本号**：不兼容的 API 修改
-   **次版本号**：向下兼容的功能性新增
-   **修订号**：向下兼容的问题修正

### 变更类型

-   **新增**：新功能
-   **修复**：问题修复
-   **变更**：现有功能的变更
-   **移除**：功能的移除
-   **安全**：安全相关的修复
