# æµ‹è¯•ç¨‹åºæ”¹è¿›æ—¥å¿—

## 2025-10-25 - ä¿®å¤é‡å¤æ³¨å†Œé—®é¢˜

### é—®é¢˜æè¿°

æµ‹è¯•ç¨‹åºå‡ºç°å¤§æ¼ æ’ä»¶çš„æ³¨å†Œã€æ³¨é”€å¾ªç¯ï¼ŒåŸå› æ˜¯æ¯ä¸ªæµ‹è¯•å‡½æ•°éƒ½åˆ›å»ºæ–°çš„ `DmExcute()` å®ä¾‹ã€‚

### åŸå§‹ä»£ç é—®é¢˜

```python
def test_bind_with_frontend_mode():
    dm = DmExcute()  # âŒ æ¯ä¸ªæµ‹è¯•éƒ½åˆ›å»ºæ–°å®ä¾‹
    # ... æµ‹è¯•ä»£ç 

def test_bind_with_default_config():
    dm = DmExcute()  # âŒ å†æ¬¡åˆ›å»ºï¼Œå¯¼è‡´é‡å¤æ³¨å†Œ
    # ... æµ‹è¯•ä»£ç 
```

**é—®é¢˜å½±å“**ï¼š

-   æ¯ä¸ªæµ‹è¯•éƒ½é‡æ–°æ³¨å†Œå¤§æ¼ æ’ä»¶
-   é€ æˆä¸å¿…è¦çš„æ³¨å†Œ/æ³¨é”€å¾ªç¯
-   å½±å“æµ‹è¯•æ€§èƒ½
-   å¯èƒ½è§¦å‘æ’ä»¶é™åˆ¶

### æ”¹è¿›æ–¹æ¡ˆ

#### 1. ä¿®æ”¹ `check_environment()` å‡½æ•°

**ä¹‹å‰**ï¼šè¿”å›å¸ƒå°”å€¼

```python
def check_environment():
    dm = DmExcute()
    # ... æ£€æŸ¥ä»£ç 
    return True  # æˆ– False
```

**ç°åœ¨**ï¼šè¿”å› dm å®ä¾‹

```python
def check_environment():
    try:
        dm = DmExcute()  # åªåˆ›å»ºä¸€æ¬¡
        # ... æ£€æŸ¥ä»£ç 
        return dm  # âœ… è¿”å›å®ä¾‹ä¾›åç»­ä½¿ç”¨
    except Exception as e:
        return None  # å¤±è´¥è¿”å› None
```

#### 2. ä¿®æ”¹æ‰€æœ‰æµ‹è¯•å‡½æ•°

**ä¹‹å‰**ï¼šæ¯ä¸ªå‡½æ•°å†…éƒ¨åˆ›å»ºå®ä¾‹

```python
def test_bind_with_frontend_mode():
    dm = DmExcute()  # âŒ é‡å¤åˆ›å»º
    hwnd = dm.FindWindow('Notepad', '')
    # ...
```

**ç°åœ¨**ï¼šæ¥æ”¶ dm å‚æ•°

```python
def test_bind_with_frontend_mode(dm):
    """æµ‹è¯•ä½¿ç”¨å‰å°æ¨¡å¼ç»‘å®šçª—å£

    Args:
        dm: DmExcute å®ä¾‹ï¼ˆé¿å…é‡å¤åˆ›å»ºï¼‰
    """
    hwnd = dm.FindWindow('Notepad', '')  # âœ… ä½¿ç”¨ä¼ å…¥çš„å®ä¾‹
    # ...
```

#### 3. ä¿®æ”¹ main å‡½æ•°

**ä¹‹å‰**ï¼š

```python
def main():
    if not check_environment():  # è¿”å› True/False
        return

    results.append(('æµ‹è¯•1', test_bind_with_frontend_mode()))  # å†…éƒ¨åˆ›å»ºå®ä¾‹
    results.append(('æµ‹è¯•2', test_bind_with_default_config()))  # åˆåˆ›å»ºå®ä¾‹
```

**ç°åœ¨**ï¼š

```python
def main():
    dm = check_environment()  # âœ… è·å–å®ä¾‹
    if dm is None:
        return

    print('ğŸ’¡ æç¤ºï¼šä½¿ç”¨å•ä¸€ dm å®ä¾‹è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œé¿å…é‡å¤æ³¨å†Œ/æ³¨é”€\n')
    results.append(('æµ‹è¯•1', test_bind_with_frontend_mode(dm)))  # âœ… ä¼ é€’å®ä¾‹
    results.append(('æµ‹è¯•2', test_bind_with_default_config(dm)))  # âœ… å…±äº«å®ä¾‹
```

### æ”¹è¿›æ•ˆæœ

#### ä¹‹å‰ï¼ˆæœ‰é—®é¢˜ï¼‰

```
[æ³¨å†Œ] åˆ›å»º DmExcute() - check_environment
[æ³¨é”€] é€€å‡º check_environment

[æ³¨å†Œ] åˆ›å»º DmExcute() - test_bind_with_frontend_mode
[æ³¨é”€] é€€å‡º test_bind_with_frontend_mode

[æ³¨å†Œ] åˆ›å»º DmExcute() - test_bind_with_default_config
[æ³¨é”€] é€€å‡º test_bind_with_default_config

... å¾ªç¯å¾€å¤ ...
```

#### ç°åœ¨ï¼ˆå·²ä¿®å¤ï¼‰

```
[æ³¨å†Œ] åˆ›å»º DmExcute() - check_environment
  â†“
ä½¿ç”¨åŒä¸€å®ä¾‹ - test_bind_with_frontend_mode
  â†“
ä½¿ç”¨åŒä¸€å®ä¾‹ - test_bind_with_default_config
  â†“
ä½¿ç”¨åŒä¸€å®ä¾‹ - test_bind_with_custom_config
  â†“
ä½¿ç”¨åŒä¸€å®ä¾‹ - test_core_engine_direct
  â†“
ä½¿ç”¨åŒä¸€å®ä¾‹ - test_architecture
  â†“
[æ³¨é”€] ç¨‹åºç»“æŸæ—¶è‡ªåŠ¨æ³¨é”€

åªæ³¨å†Œä¸€æ¬¡ï¼âœ…
```

### ä¼˜ç‚¹

1. **æ€§èƒ½æå‡**

    - åªæ³¨å†Œä¸€æ¬¡å¤§æ¼ æ’ä»¶
    - å‡å°‘ä¸å¿…è¦çš„åˆå§‹åŒ–å¼€é”€
    - æµ‹è¯•è¿è¡Œæ›´å¿«

2. **èµ„æºå‹å¥½**

    - é¿å…é¢‘ç¹çš„æ³¨å†Œ/æ³¨é”€æ“ä½œ
    - å‡å°‘ç³»ç»Ÿèµ„æºæ¶ˆè€—
    - ä¸ä¼šè§¦å‘æ’ä»¶ä½¿ç”¨é™åˆ¶

3. **ä»£ç æ¸…æ™°**

    - æ˜ç¡®è¡¨è¾¾"å…±äº«å®ä¾‹"çš„æ„å›¾
    - ä¾¿äºç†è§£ç¨‹åºæµç¨‹
    - æ›´å®¹æ˜“ç»´æŠ¤

4. **ç¨³å®šæ€§æå‡**
    - é¿å…å¯èƒ½çš„æ³¨å†Œå†²çª
    - å‡å°‘å¤±è´¥æ¦‚ç‡
    - æ›´å¯é çš„æµ‹è¯•ç»“æœ

### ä½¿ç”¨ç¤ºä¾‹

```bash
# è¿è¡Œæ”¹è¿›åçš„æµ‹è¯•
uv run examples/test_bind_window.py

# é¢„æœŸè¾“å‡º
çª—å£ç»‘å®šåŠŸèƒ½æµ‹è¯•
============================================================
ç¯å¢ƒæ£€æŸ¥
âœ“ ç®¡ç†å‘˜æƒé™: å¦
âœ“ å¤§æ¼ æ’ä»¶: å·²åŠ è½½
  - ç‰ˆæœ¬: 7.2129
  - ID: xxx

ğŸ’¡ æç¤ºï¼šä½¿ç”¨å•ä¸€ dm å®ä¾‹è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œé¿å…é‡å¤æ³¨å†Œ/æ³¨é”€

============================================================
æµ‹è¯•0: ä½¿ç”¨å‰å°æ¨¡å¼ç»‘å®šçª—å£ï¼ˆæ— éœ€ç®¡ç†å‘˜ï¼‰
============================================================
âœ“ æ‰¾åˆ°çª—å£å¥æŸ„: 2428674
âœ“ å‰å°æ¨¡å¼ç»‘å®šæˆåŠŸ
...
```

### æ³¨æ„äº‹é¡¹

1. **å®ä¾‹ç”Ÿå‘½å‘¨æœŸ**

    - dm å®ä¾‹åœ¨æ•´ä¸ªæµ‹è¯•æœŸé—´ä¿æŒæ´»è·ƒ
    - ç¨‹åºç»“æŸæ—¶è‡ªåŠ¨æ³¨é”€

2. **é”™è¯¯å¤„ç†**

    - å¦‚æœç¯å¢ƒæ£€æŸ¥å¤±è´¥ï¼ˆdm = Noneï¼‰ï¼Œæ‰€æœ‰æµ‹è¯•éƒ½ä¼šè¢«è·³è¿‡
    - è¿™æ˜¯é¢„æœŸè¡Œä¸ºï¼Œå› ä¸ºæ²¡æœ‰æœ‰æ•ˆçš„ dm å®ä¾‹

3. **å‘åå…¼å®¹**
    - ä¸å½±å“æµ‹è¯•ç»“æœ
    - åªæ˜¯æ”¹è¿›äº†å®ç°æ–¹å¼
    - æ‰€æœ‰æµ‹è¯•åŠŸèƒ½ä¿æŒä¸å˜

### ç›¸å…³æ–‡ä»¶

-   `examples/test_bind_window.py` - ä¸»æµ‹è¯•æ–‡ä»¶ï¼ˆå·²ä¿®å¤ï¼‰
-   `examples/test_bind_params.py` - å‚æ•°éªŒè¯æµ‹è¯•ï¼ˆæ— æ­¤é—®é¢˜ï¼‰
-   `examples/README_æµ‹è¯•è¯´æ˜.md` - æµ‹è¯•ä½¿ç”¨è¯´æ˜

### æŠ€æœ¯ç»†èŠ‚

#### å‡½æ•°ç­¾åå˜åŒ–

| å‡½æ•°                            | ä¹‹å‰      | ç°åœ¨               |
| ------------------------------- | --------- | ------------------ |
| check_environment()             | â†’ bool    | â†’ DmExcute \| None |
| test_bind_with_frontend_mode()  | () â†’ bool | (dm) â†’ bool        |
| test_bind_with_default_config() | () â†’ bool | (dm) â†’ bool        |
| test_bind_with_custom_config()  | () â†’ bool | (dm) â†’ bool        |
| test_core_engine_direct()       | () â†’ bool | (dm) â†’ bool        |
| test_architecture()             | () â†’ bool | (dm) â†’ bool        |

#### å®ä¾‹ç®¡ç†

```python
# åˆ›å»ºå®ä¾‹ï¼ˆåªåœ¨ check_environment ä¸­ï¼‰
dm = DmExcute()

# ä¼ é€’å®ä¾‹ï¼ˆæ‰€æœ‰æµ‹è¯•å‡½æ•°ï¼‰
def test_xxx(dm):
    # ä½¿ç”¨ä¼ å…¥çš„ dm å®ä¾‹
    hwnd = dm.FindWindow(...)
    dm.ç»‘å®šçª—å£(hwnd)
    dm.è§£ç»‘çª—å£()
```

### æ€»ç»“

âœ… **é—®é¢˜**ï¼šé‡å¤åˆ›å»ºå®ä¾‹å¯¼è‡´æ³¨å†Œ/æ³¨é”€å¾ªç¯
âœ… **è§£å†³**ï¼šå…±äº«å•ä¸€å®ä¾‹ï¼Œåªæ³¨å†Œä¸€æ¬¡
âœ… **æ•ˆæœ**ï¼šæ€§èƒ½æå‡ï¼Œèµ„æºå‹å¥½ï¼Œæ›´ç¨³å®š
âœ… **å½±å“**ï¼šæ— ç ´åæ€§å˜æ›´ï¼Œæµ‹è¯•ç»“æœä¸å˜

è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ”¹è¿›ï¼Œè§£å†³äº†æµ‹è¯•ç¨‹åºçš„æ ¸å¿ƒé—®é¢˜ï¼Œè®©æµ‹è¯•æ›´åŠ é«˜æ•ˆå’Œå¯é ï¼
